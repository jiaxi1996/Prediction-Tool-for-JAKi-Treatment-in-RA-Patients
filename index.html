<!DOCTYPE html>
<html lang='en'>
<head>
    <meta charset='UTF-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <title>Prediction Tool for 3-month JAKi Treatment Outcomes in RA Patients</title>
    <style>
        body { font-family: 'Times New Roman', serif; margin: 40px; background-color: #f7f7f7; color: #333333; font-size: 16px; }
        h1 { text-align: center; margin-bottom: 20px; font-size: 28px; }
        .container { max-width: 1000px; margin: 0 auto; background-color: #fff; padding: 25px 35px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .form-row { display: flex; flex-wrap: wrap; gap: 20px; }
        .form-group { flex: 1 1 calc(50% - 20px); display: flex; flex-direction: column; margin-bottom: 10px; }
        .form-group label { font-size: 16px; margin-bottom: 5px; }
        .form-group input, .form-group select { padding: 7px; font-size: 16px; border: 1px solid #ccc; border-radius: 4px; }
        #predictBtn { display: block; margin: 30px auto 10px; padding: 12px 36px; font-size: 18px; background-color: #4a8fd7; color: #fff; border: none; border-radius: 4px; cursor: pointer; }
        #predictBtn:hover { background-color: #3e78ba; }
        #result { text-align: center; margin-top: 25px; font-size: 18px; font-weight: bold; }
    </style>
</head>
<body>
    <h1>Prediction Tool for 3-month JAKi Treatment Outcomes in RA Patients</h1>
    <div class='container'>
        <div class='form-group'>
            <label for='outcome'>Select Outcome Variable:</label>
            <select id='outcome' style='font-size:16px; padding:7px;'>
                <option value='3-month DAS28CRP remission(True=1,false=0)'>3-month DAS28CRP remission</option>
                <option value='3-month DAS28ESR remission(True=1,false=0)'>3-month DAS28ESR remission</option>
                <option value='3-month SDAI remission(True=1,false=0)'>3-month SDAI remission</option>
                <option value='3-month CDAI remission(True=1,false=0)'>3-month CDAI remission</option>
            </select>
        </div>
        <div class='form-row'>
            <div class='form-group'>
                <label for='Gender(Female=0,male=1)'>Gender(Female=0,male=1):</label>
                <select id='Gender(Female=0,male=1)'>
                    <option value=''>Select</option>
                    <option value='0'>0</option>
                    <option value='1'>1</option>
                </select>
            </div>
            <div class='form-group'>
                <label for='Age(years)'>Age(years):</label>
                <input type='number' id='Age(years)' placeholder='Enter value' step='any'>
            </div>
            <div class='form-group'>
                <label for='Duration from diagnosis(months)'>Duration from diagnosis(months):</label>
                <input type='number' id='Duration from diagnosis(months)' placeholder='Enter value' step='any'>
            </div>
            <div class='form-group'>
                <label for='BMI'>BMI:</label>
                <input type='number' id='BMI' placeholder='Enter value' step='any'>
            </div>
            <div class='form-group'>
                <label for='JAKi naive(True=1,false=0)'>JAKi naive(True=1,false=0):</label>
                <select id='JAKi naive(True=1,false=0)'>
                    <option value=''>Select</option>
                    <option value='0'>0</option>
                    <option value='1'>1</option>
                </select>
            </div>
            <div class='form-group'>
                <label for='Treatment naive(True=1,false=0)'>Treatment naive(True=1,false=0):</label>
                <select id='Treatment naive(True=1,false=0)'>
                    <option value=''>Select</option>
                    <option value='0'>0</option>
                    <option value='1'>1</option>
                </select>
            </div>
            <div class='form-group'>
                <label for='Tofa at Baseline(True=1,false=0)'>Tofa at Baseline(True=1,false=0):</label>
                <select id='Tofa at Baseline(True=1,false=0)'>
                    <option value=''>Select</option>
                    <option value='0'>0</option>
                    <option value='1'>1</option>
                </select>
            </div>
            <div class='form-group'>
                <label for='Bari at Baseline(True=1,false=0)'>Bari at Baseline(True=1,false=0):</label>
                <select id='Bari at Baseline(True=1,false=0)'>
                    <option value=''>Select</option>
                    <option value='0'>0</option>
                    <option value='1'>1</option>
                </select>
            </div>
            <div class='form-group'>
                <label for='Upa at Baseline(True=1,false=0)'>Upa at Baseline(True=1,false=0):</label>
                <select id='Upa at Baseline(True=1,false=0)'>
                    <option value=''>Select</option>
                    <option value='0'>0</option>
                    <option value='1'>1</option>
                </select>
            </div>
            <div class='form-group'>
                <label for='MTX at baseline(True=1,false=0)'>MTX at baseline(True=1,false=0):</label>
                <select id='MTX at baseline(True=1,false=0)'>
                    <option value=''>Select</option>
                    <option value='0'>0</option>
                    <option value='1'>1</option>
                </select>
            </div>
            <div class='form-group'>
                <label for='Other cDMARD at baseline(True=1,false=0)'>Other cDMARD at baseline(True=1,false=0):</label>
                <select id='Other cDMARD at baseline(True=1,false=0)'>
                    <option value=''>Select</option>
                    <option value='0'>0</option>
                    <option value='1'>1</option>
                </select>
            </div>
            <div class='form-group'>
                <label for='Prior bDMARD(True=1,false=0)'>Prior bDMARD(True=1,false=0):</label>
                <select id='Prior bDMARD(True=1,false=0)'>
                    <option value=''>Select</option>
                    <option value='0'>0</option>
                    <option value='1'>1</option>
                </select>
            </div>
            <div class='form-group'>
                <label for='Glucocorticoid(True=1,false=0) at baseline'>Glucocorticoid(True=1,false=0) at baseline:</label>
                <select id='Glucocorticoid(True=1,false=0) at baseline'>
                    <option value=''>Select</option>
                    <option value='0'>0</option>
                    <option value='1'>1</option>
                </select>
            </div>
            <div class='form-group'>
                <label for='Baseline TJC'>Baseline TJC:</label>
                <input type='number' id='Baseline TJC' placeholder='Enter value' step='any'>
            </div>
            <div class='form-group'>
                <label for='Baseline SJC'>Baseline SJC:</label>
                <input type='number' id='Baseline SJC' placeholder='Enter value' step='any'>
            </div>
            <div class='form-group'>
                <label for='Baseline PGA(0-100)'>Baseline PGA(0-100):</label>
                <input type='number' id='Baseline PGA(0-100)' placeholder='Enter value' step='any'>
            </div>
            <div class='form-group'>
                <label for='Baseline EGA(0-100)'>Baseline EGA(0-100):</label>
                <input type='number' id='Baseline EGA(0-100)' placeholder='Enter value' step='any'>
            </div>
            <div class='form-group'>
                <label for='Baseline ESR(mm/h)'>Baseline ESR(mm/h):</label>
                <input type='number' id='Baseline ESR(mm/h)' placeholder='Enter value' step='any'>
            </div>
            <div class='form-group'>
                <label for='Baseline CRP(mg/L)'>Baseline CRP(mg/L):</label>
                <input type='number' id='Baseline CRP(mg/L)' placeholder='Enter value' step='any'>
            </div>
            <div class='form-group'>
                <label for='Baseline RF positive(True=1,false=0)'>Baseline RF positive(True=1,false=0):</label>
                <select id='Baseline RF positive(True=1,false=0)'>
                    <option value=''>Select</option>
                    <option value='0'>0</option>
                    <option value='1'>1</option>
                </select>
            </div>

        </div>
        <button id='predictBtn'>Predict</button>
        <div id='result'></div>
    </div>
    <script>
        const modelData = {"continuous_features": ["Age(years)", "Duration from diagnosis(months)", "BMI", "Baseline TJC", "Baseline SJC", "Baseline PGA(0-100)", "Baseline EGA(0-100)", "Baseline ESR(mm/h)", "Baseline CRP(mg/L)"], "binary_features": ["Gender(Female=0,male=1)", "JAKi naive(True=1,false=0)", "Treatment naive(True=1,false=0)", "Tofa at Baseline(True=1,false=0)", "Bari at Baseline(True=1,false=0)", "Upa at Baseline(True=1,false=0)", "MTX at baseline(True=1,false=0)", "Other cDMARD at baseline(True=1,false=0)", "Prior bDMARD(True=1,false=0)", "Glucocorticoid(True=1,false=0) at baseline", "Baseline RF positive(True=1,false=0)"], "feature_order": ["Gender(Female=0,male=1)", "Age(years)", "Duration from diagnosis(months)", "BMI", "JAKi naive(True=1,false=0)", "Treatment naive(True=1,false=0)", "Tofa at Baseline(True=1,false=0)", "Bari at Baseline(True=1,false=0)", "Upa at Baseline(True=1,false=0)", "MTX at baseline(True=1,false=0)", "Other cDMARD at baseline(True=1,false=0)", "Prior bDMARD(True=1,false=0)", "Glucocorticoid(True=1,false=0) at baseline", "Baseline TJC", "Baseline SJC", "Baseline PGA(0-100)", "Baseline EGA(0-100)", "Baseline ESR(mm/h)", "Baseline CRP(mg/L)", "Baseline RF positive(True=1,false=0)"], "means": [56.932415395992535, 99.20386461011141, 22.85685000831725, 5.557840616966581, 3.665809768637532, 43.645244215938305, 40.087969151670954, 37.77223650385604, 18.32048843187661], "scales": [14.71679987323122, 103.23558474293446, 2.8225827885132766, 6.166904909246374, 4.562210731731624, 23.012964028395718, 21.90622207954932, 27.214079419455583, 25.163855388500433], "logistic_models": {"3-month DAS28CRP remission(True=1,false=0)": {"intercept": 0.4191476968755114, "coef": [0.5537887697444167, -0.20773156834161782, -0.07066197676758564, 0.0909301028742439, 0.24871910002264583, 0.1616538872406928, 0.2164188762138281, -0.22851697010777727, 0.029347721446907667, 0.049508703886108535, -0.3981188016017615, -0.6050259291809598, -0.06926052770344283, -0.4721542364048976, 0.03609883244856728, -0.18861861684024417, -0.14909933478590898, 0.14281054520442354, -0.44213195261298827, 0.025513599273724975]}, "3-month DAS28ESR remission(True=1,false=0)": {"intercept": -0.4912629954451513, "coef": [0.9821892109679181, -0.27890150683999276, -0.0813928905954427, 0.06378047494568494, 0.5398249380168268, 0.2637398567711611, -0.03585227788254314, -0.33568340278307307, 0.3706947329083379, -0.04096432995059457, -0.4000944409906175, -0.5647228988816826, -0.27429712398075845, -0.6825594693303985, 0.23960874297569668, -0.2679193721543783, 0.032327548911082984, -0.7166996950056981, 0.043980129652738995, -0.12645636516491335]}, "3-month SDAI remission(True=1,false=0)": {"intercept": -0.6174159565723647, "coef": [0.24223087633563134, -0.3035710882259549, -0.22494830323628287, 0.14205941795028593, 0.24614212766947066, 0.09828803809496502, -0.02958666615523378, -0.24451884054041254, 0.277507218296769, -0.2848553276494713, -0.471082909170678, -0.8207306453724805, -0.08041405467868051, -0.5483139425894517, 0.3473990819781536, -0.3540913561995192, -0.280569566039621, -0.09504778041159044, -0.38414052178236135, 0.1947636527440842]}}, "rf_model": {"trees": [{"feature": "Age(years)", "threshold": 0.37831489741802216, "left": {"feature": "Baseline EGA(0-100)", "threshold": -0.3463842049241066, "left": {"feature": "Baseline CRP(mg/L)", "threshold": -0.6285001933574677, "left": {"value": [0.3392857142857143, 0.6607142857142857]}, "right": {"value": [0.5616438356164384, 0.4383561643835616]}}, "right": {"feature": "Age(years)", "threshold": -1.2524744272232056, "left": {"value": [1.0, 0.0]}, "right": {"value": [0.6375, 0.3625]}}}, "right": {"feature": "JAKi naive(True=1,false=0)", "threshold": 0.5, "left": {"feature": "Baseline CRP(mg/L)", "threshold": -0.20189626514911652, "left": {"value": [1.0, 0.0]}, "right": {"value": [0.8571428571428571, 0.14285714285714285]}}, "right": {"feature": "Baseline CRP(mg/L)", "threshold": 1.8073347806930542, "left": {"value": [0.7623762376237624, 0.2376237623762376]}, "right": {"value": [1.0, 0.0]}}}}, {"feature": "Baseline ESR(mm/h)", "threshold": -0.04674920253455639, "left": {"feature": "Prior bDMARD(True=1,false=0)", "threshold": 0.5, "left": {"feature": "BMI", "threshold": 1.0492547750473022, "left": {"value": [0.524822695035461, 0.475177304964539]}, "right": {"value": [0.8387096774193549, 0.16129032258064516]}}, "right": {"feature": "Baseline CRP(mg/L)", "threshold": -0.6420116722583771, "left": {"value": [0.95, 0.05]}, "right": {"value": [0.6521739130434783, 0.34782608695652173]}}}, "right": {"feature": "Baseline TJC", "threshold": -0.8201586902141571, "left": {"feature": "MTX at baseline(True=1,false=0)", "threshold": 0.5, "left": {"value": [0.0, 1.0]}, "right": {"value": [1.0, 0.0]}}, "right": {"feature": "Baseline EGA(0-100)", "threshold": -1.031121164560318, "left": {"value": [0.25, 0.75]}, "right": {"value": [0.8540145985401459, 0.145985401459854]}}}}, {"feature": "Baseline ESR(mm/h)", "threshold": 0.17372491210699081, "left": {"feature": "Duration from diagnosis(months)", "threshold": 1.7755131125450134, "left": {"feature": "Age(years)", "threshold": 0.9898608922958374, "left": {"value": [0.5358851674641149, 0.46411483253588515]}, "right": {"value": [0.8723404255319149, 0.1276595744680851]}}, "right": {"value": [1.0, 0.0]}}, "right": {"feature": "Baseline PGA(0-100)", "threshold": 0.05886925011873245, "left": {"feature": "Baseline EGA(0-100)", "threshold": -1.4876124858856201, "left": {"value": [0.0, 1.0]}, "right": {"value": [0.7333333333333333, 0.26666666666666666]}}, "right": {"feature": "Baseline SJC", "threshold": 1.607595682144165, "left": {"value": [0.9454545454545454, 0.05454545454545454]}, "right": {"value": [0.7692307692307693, 0.23076923076923078]}}}}, {"feature": "Tofa at Baseline(True=1,false=0)", "threshold": 0.5, "left": {"feature": "Baseline CRP(mg/L)", "threshold": 0.9620748162269592, "left": {"feature": "Baseline ESR(mm/h)", "threshold": -0.9653913378715515, "left": {"value": [0.9375, 0.0625]}, "right": {"value": [0.6194029850746269, 0.3805970149253731]}}, "right": {"feature": "Age(years)", "threshold": 1.329608678817749, "left": {"value": [1.0, 0.0]}, "right": {"value": [0.5, 0.5]}}}, "right": {"feature": "Baseline EGA(0-100)", "threshold": 0.22422994603402913, "left": {"feature": "Duration from diagnosis(months)", "threshold": 0.23534651845693588, "left": {"value": [0.43956043956043955, 0.5604395604395604]}, "right": {"value": [0.7241379310344828, 0.27586206896551724]}}, "right": {"feature": "Baseline CRP(mg/L)", "threshold": 0.5316956043243408, "left": {"value": [0.75, 0.25]}, "right": {"value": [0.9705882352941176, 0.029411764705882353]}}}}, {"feature": "BMI", "threshold": 1.237572193145752, "left": {"feature": "Baseline EGA(0-100)", "threshold": 0.20140537549741566, "left": {"feature": "Age(years)", "threshold": 0.9219113290309906, "left": {"value": [0.38311688311688313, 0.6168831168831169]}, "right": {"value": [0.7169811320754716, 0.2830188679245283]}}, "right": {"feature": "BMI", "threshold": -1.9192593693733215, "left": {"value": [0.25, 0.75]}, "right": {"value": [0.8978102189781022, 0.10218978102189781]}}}, "right": {"feature": "BMI", "threshold": 3.6998560428619385, "left": {"feature": "Baseline CRP(mg/L)", "threshold": -0.4431152641773224, "left": {"value": [0.8125, 0.1875]}, "right": {"value": [1.0, 0.0]}}, "right": {"value": [0.0, 1.0]}}}, {"feature": "Baseline PGA(0-100)", "threshold": 0.16750366985797882, "left": {"feature": "BMI", "threshold": 1.184429407119751, "left": {"feature": "BMI", "threshold": 0.7273834943771362, "left": {"value": [0.5290322580645161, 0.47096774193548385]}, "right": {"value": [0.22727272727272727, 0.7727272727272727]}}, "right": {"feature": "Duration from diagnosis(months)", "threshold": 0.3202655613422394, "left": {"value": [1.0, 0.0]}, "right": {"value": [0.5, 0.5]}}}, "right": {"feature": "Baseline ESR(mm/h)", "threshold": -0.524443119764328, "left": {"feature": "Bari at Baseline(True=1,false=0)", "threshold": 0.5, "left": {"value": [0.5121951219512195, 0.4878048780487805]}, "right": {"value": [0.8666666666666667, 0.13333333333333333]}}, "right": {"feature": "Bari at Baseline(True=1,false=0)", "threshold": 0.5, "left": {"value": [0.8709677419354839, 0.12903225806451613]}, "right": {"value": [0.9583333333333334, 0.041666666666666664]}}}}, {"feature": "Baseline ESR(mm/h)", "threshold": 1.276095449924469, "left": {"feature": "Baseline EGA(0-100)", "threshold": -0.3463842049241066, "left": {"feature": "Baseline TJC", "threshold": -0.8201586902141571, "left": {"value": [0.24, 0.76]}, "right": {"value": [0.6015625, 0.3984375]}}, "right": {"feature": "Duration from diagnosis(months)", "threshold": 1.121668815612793, "left": {"value": [0.6551724137931034, 0.3448275862068966]}, "right": {"value": [1.0, 0.0]}}}, "right": {"feature": "Baseline CRP(mg/L)", "threshold": 0.43771159648895264, "left": {"feature": "Baseline ESR(mm/h)", "threshold": 2.1947375535964966, "left": {"value": [0.4, 0.6]}, "right": {"value": [1.0, 0.0]}}, "right": {"feature": "Age(years)", "threshold": 1.1257599592208862, "left": {"value": [1.0, 0.0]}, "right": {"value": [0.8, 0.2]}}}}, {"feature": "Baseline EGA(0-100)", "threshold": -0.3463842049241066, "left": {"feature": "Baseline PGA(0-100)", "threshold": -1.1361094117164612, "left": {"feature": "Baseline CRP(mg/L)", "threshold": -0.682347297668457, "left": {"value": [1.0, 0.0]}, "right": {"value": [0.14705882352941177, 0.8529411764705882]}}, "right": {"feature": "Baseline CRP(mg/L)", "threshold": 1.8073347806930542, "left": {"value": [0.5111111111111111, 0.4888888888888889]}, "right": {"value": [1.0, 0.0]}}}, "right": {"feature": "Baseline ESR(mm/h)", "threshold": 0.7065373361110687, "left": {"feature": "Baseline SJC", "threshold": 0.18284781649708748, "left": {"value": [0.8404255319148937, 0.1595744680851064]}, "right": {"value": [0.6274509803921569, 0.37254901960784315]}}, "right": {"feature": "BMI", "threshold": -2.5097830295562744, "left": {"value": [0.0, 1.0]}, "right": {"value": [0.9838709677419355, 0.016129032258064516]}}}}, {"feature": "Baseline EGA(0-100)", "threshold": -0.3463842049241066, "left": {"feature": "Duration from diagnosis(months)", "threshold": -0.9012124836444855, "left": {"feature": "Bari at Baseline(True=1,false=0)", "threshold": 0.5, "left": {"value": [0.27586206896551724, 0.7241379310344828]}, "right": {"value": [0.0, 1.0]}}, "right": {"feature": "Baseline EGA(0-100)", "threshold": -0.8028754889965057, "left": {"value": [0.5157894736842106, 0.4842105263157895]}, "right": {"value": [0.6949152542372882, 0.3050847457627119]}}}, "right": {"feature": "Baseline ESR(mm/h)", "threshold": 1.1107398867607117, "left": {"feature": "Baseline TJC", "threshold": -0.33369098603725433, "left": {"value": [0.5652173913043478, 0.43478260869565216]}, "right": {"value": [0.7543859649122807, 0.24561403508771928]}}, "right": {"value": [1.0, 0.0]}}}, {"feature": "Baseline PGA(0-100)", "threshold": 0.16750366985797882, "left": {"feature": "Age(years)", "threshold": 0.9219113290309906, "left": {"feature": "MTX at baseline(True=1,false=0)", "threshold": 0.5, "left": {"value": [0.5411764705882353, 0.4588235294117647]}, "right": {"value": [0.43434343434343436, 0.5656565656565656]}}, "right": {"feature": "BMI", "threshold": 0.6352869272232056, "left": {"value": [0.9259259259259259, 0.07407407407407407]}, "right": {"value": [0.5555555555555556, 0.4444444444444444]}}}, "right": {"feature": "Age(years)", "threshold": 0.44626446068286896, "left": {"feature": "BMI", "threshold": 0.07372080534696579, "left": {"value": [0.8, 0.2]}, "right": {"value": [0.4444444444444444, 0.5555555555555556]}}, "right": {"feature": "Duration from diagnosis(months)", "threshold": -0.8592373132705688, "left": {"value": [0.5294117647058824, 0.47058823529411764]}, "right": {"value": [0.9565217391304348, 0.043478260869565216]}}}}], "n_estimators": 10}};
        function scaleFeatures(values) {
            const scaled = [];
            const continuousFeatures = modelData.continuous_features;
            const means = modelData.means;
            const scales = modelData.scales;
            modelData.feature_order.forEach(function(feature) {
                const val = parseFloat(values[feature]);
                const contIndex = continuousFeatures.indexOf(feature);
                if (contIndex !== -1) {
                    const mean = means[contIndex];
                    const scale = scales[contIndex];
                    scaled.push((val - mean) / scale);
                } else {
                    scaled.push(val);
                }
            });
            return scaled;
        }
        function predictLogistic(outcome, scaledFeatures) {
            const model = modelData.logistic_models[outcome];
            let z = model.intercept;
            model.coef.forEach(function(coef, idx) {
                z += coef * scaledFeatures[idx];
            });
            const prob = 1 / (1 + Math.exp(-z));
            return prob;
        }
        function predictTree(tree, features) {
            if (tree.value !== undefined) {
                return tree.value[1];
            } else {
                const idx = modelData.feature_order.indexOf(tree.feature);
                if (features[idx] <= tree.threshold) {
                    return predictTree(tree.left, features);
                } else {
                    return predictTree(tree.right, features);
                }
            }
        }
        function predictRandomForest(scaledFeatures) {
            const trees = modelData.rf_model.trees;
            let sumProb = 0;
            trees.forEach(function(tree) {
                sumProb += predictTree(tree, scaledFeatures);
            });
            return sumProb / trees.length;
        }
        document.getElementById('predictBtn').addEventListener('click', function() {
            const values = {};
            let missing = false;
            modelData.feature_order.forEach(function(feature) {
                const el = document.getElementById(feature);
                const val = el.value;
                if (val === '' || val === null) {
                    missing = true;
                }
                values[feature] = val;
            });
            const resultEl = document.getElementById('result');
            if (missing) {
                resultEl.innerText = 'Please enter/select all predictor values.';
                return;
            }
            const scaled = scaleFeatures(values);
            const outcome = document.getElementById('outcome').value;
            let prob;
            if (outcome === '3-month CDAI remission(True=1,false=0)') {
                prob = predictRandomForest(scaled);
            } else {
                prob = predictLogistic(outcome, scaled);
            }
            const prediction = prob >= 0.5 ? 1 : 0;
            const probPercent = (prob * 100).toFixed(2);
            resultEl.innerText = 'Predicted Outcome: ' + prediction + ' (Probability: ' + probPercent + '%)';
        });
    </script>
</body>
</html>